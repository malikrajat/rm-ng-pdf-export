{"version":3,"file":"codewithrajat-rm-ng-pdf-export.mjs","sources":["../../../projects/rm-ng-pdf-export/src/lib/tokens/pdf-export-config.token.ts","../../../projects/rm-ng-pdf-export/src/lib/services/pdf-export.service.ts","../../../projects/rm-ng-pdf-export/src/lib/directives/pdf-export.directive.ts","../../../projects/rm-ng-pdf-export/src/lib/components/pdf-export.component.ts","../../../projects/rm-ng-pdf-export/src/codewithrajat-rm-ng-pdf-export.ts"],"sourcesContent":["// pdf-export-config.token.ts\r\nimport { InjectionToken } from '@angular/core';\r\n\r\nexport interface PdfExportConfig {\r\n  pageSize?: string; // e.g. 'A4'\r\n  orientation?: 'portrait' | 'landscape';\r\n  margins?: { top: number; bottom: number; left: number; right: number };\r\n  filename?: string;\r\n  metadata?: { title?: string; author?: string; subject?: string };\r\n  openInNewTab?: boolean;\r\n}\r\n\r\nexport const PDF_EXPORT_CONFIG = new InjectionToken<PdfExportConfig>('PDF_EXPORT_CONFIG');\r\n","import { Injectable, Inject, PLATFORM_ID } from '@angular/core';\r\nimport { isPlatformBrowser } from '@angular/common';\r\nimport {PDFDocument, PDFImage, PDFPage} from 'pdf-lib';\r\nimport { PDF_EXPORT_CONFIG, PdfExportConfig } from '../tokens/pdf-export-config.token';\r\nimport html2canvas from 'html2canvas';\r\n\r\n@Injectable()\r\nexport class PdfExportService {\r\n  constructor(\r\n    @Inject(PDF_EXPORT_CONFIG) private config: PdfExportConfig,\r\n    @Inject(PLATFORM_ID) private platformId: object\r\n  ) {}\r\n\r\n  async exportHtml(element: HTMLElement, overrideConfig?: PdfExportConfig): Promise<void> {\r\n    if (!isPlatformBrowser(this.platformId)) {\r\n      throw new Error('PDF export is only supported in browser environments.');\r\n    }\r\n\r\n    const config = { ...this.config, ...overrideConfig };\r\n\r\n    const canvas: HTMLCanvasElement = await html2canvas(element);\r\n    const imgData: string = canvas.toDataURL('image/png');\r\n\r\n    const pdf: PDFDocument = await PDFDocument.create();\r\n    const page:PDFPage = pdf.addPage([\r\n      this._widthPxToPt(canvas.width),\r\n      this._heightPxToPt(canvas.height),\r\n    ]);\r\n\r\n    const png:PDFImage = await pdf.embedPng(imgData);\r\n    page.drawImage(png, {\r\n      x: 0,\r\n      y: 0,\r\n      width: page.getWidth(),\r\n      height: page.getHeight()\r\n    });\r\n\r\n    if (config.metadata) {\r\n      pdf.setTitle(config.metadata.title || '');\r\n      pdf.setAuthor(config.metadata.author || '');\r\n      pdf.setSubject(config.metadata.subject || '');\r\n    }\r\n\r\n    const bytes: Uint8Array<ArrayBufferLike> = await pdf.save();\r\n    this._triggerDownload(bytes, config.filename || 'document.pdf', config.openInNewTab);\r\n  }\r\n\r\n  private _triggerDownload(data: Uint8Array, filename: string, openInNewTab?: boolean): void {\r\n    const blob = new Blob([data], { type: 'application/pdf' });\r\n    const url: string = URL.createObjectURL(blob);\r\n\r\n    if (openInNewTab) {\r\n      window.open(url, '_blank');\r\n    } else {\r\n      const a: HTMLAnchorElement = document.createElement('a');\r\n      a.href = url;\r\n      a.download = filename;\r\n      a.click();\r\n    }\r\n\r\n    URL.revokeObjectURL(url);\r\n  }\r\n\r\n  private _widthPxToPt(px: number): number {\r\n    return (px * 72) / 96;\r\n  }\r\n\r\n  private _heightPxToPt(px: number): number {\r\n    return (px * 72) / 96;\r\n  }\r\n}\r\n","// pdf-export.directive.ts\r\nimport {Directive, ElementRef, HostListener, Input} from '@angular/core';\r\nimport { PdfExportService } from '../services/pdf-export.service';\r\nimport {PdfExportConfig} from '../tokens/pdf-export-config.token';\r\n\r\n@Directive({\r\n  selector: '[rmPdfExport]',\r\n  standalone: true,\r\n})\r\n\r\nexport class PdfExportDirective {\r\n  @Input() pdfConfig?: PdfExportConfig;\r\n\r\n  constructor(private el: ElementRef, private svc: PdfExportService) {}\r\n\r\n  @HostListener('click')\r\n  async onClick(): Promise<void> {\r\n    await this.svc.exportHtml(this.el.nativeElement, this.pdfConfig);\r\n  }\r\n}\r\n","// pdf-export.component.ts\r\nimport { Component, ContentChild, ElementRef, AfterContentInit } from '@angular/core';\r\nimport { PdfExportService } from '../services/pdf-export.service';\r\n\r\n@Component({\r\n  selector: 'rm-pdf-export',\r\n  template: `<ng-content></ng-content><button (click)=\"export()\">Export PDF</button>`\r\n})\r\nexport class PdfExportComponent implements AfterContentInit {\r\n  @ContentChild('pdfContent', { read: ElementRef, static: true }) content!: ElementRef;\r\n  constructor(private svc: PdfExportService) {}\r\n  ngAfterContentInit(): void {}\r\n  async export(): Promise<void> {\r\n    await this.svc.exportHtml(this.content.nativeElement);\r\n  }\r\n}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["i1.PdfExportService"],"mappings":"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"}